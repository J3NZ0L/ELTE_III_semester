<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="hu" lang="hu">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="css/scormelte_alap.css" rel="stylesheet" type="text/css" title="" />
<link href="css/style_spec.css" rel="stylesheet" type="text/css" />
<link href="css/scormelte_nagy.css" rel="alternate stylesheet" type="text/css" title="nagy" />
<link href="css/scormelte_inverz.css" rel="alternate stylesheet" type="text/css" title="inverz" />
<!--[if lte IE 6]>
<link href="css/scormelte_ie6.css" rel="stylesheet" type="text/css" title="" />
<![endif]-->
<!-- syntax highlight -->
<link rel="stylesheet" type="text/css" href="css/shCore.css" />
<link rel="stylesheet" type="text/css" href="css/shThemeDefault.css" />
<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushCpp.js"></script>
<script type="text/javascript" src="js/shBrushCSharp.js"></script>
<script type="text/javascript" src="js/shBrushDelphi.js"></script>
<script type="text/javascript" src="js/shBrushXml.js"></script>
<script type="text/javascript" src="js/shBrushCss.js"></script>
<script type="text/javascript" src="js/shBrushJScript.js"></script>
<script type="text/javascript" src="js/shBrushSql.js"></script>
<script type="text/javascript">
SyntaxHighlighter.all()
</script>
<title>
Számítógépes alapismeretek II. / 
<span class="fogalom" title="szignál">szignálok</span>, a szülő-gyerek viszony gyakorlati szempontból
/Feladat: készítsünk egy egyszerű &#132;démon&#148; programot! </title>
<meta name="description" content="A tananyag  fejlesztése a TÁMOP-4.1.2.A/2-10/1 pályázat keretén belül történt." />
<meta name="keywords" content="Hardver alapismeretek, operációs rendszer, számítógépes alapismeretek, operációs rendszer fogalma, operációs rendszerek története, operációs rendszer feladata, operációs rendszer generációk, operációs rendszer típusok, folyamatok, folyamat táblázat, szál &ndash; folyamatok, rendszerhívások, operációs rendszer struktúrák, kernelmód, kernel, felhasználói mód, B/K művelet, folyamatok modellje, szinkron rendszerhívás, asszinkron rendszerhívás, állapotai, megvalósításuk, folyamatok kommunikációja, IPC (Inter Process Communication), megszakítástábla, IDT, megszakításvezérlő, PIC, megszakítás, interrupt, megszakításkérelem, IRQ, megszakításkezelési folyamat, kivétel, hibakeresés (debuggolás), töréspont, fájlrendszer, MBR, partíciós szektor, Ntldr, klaszter (cluster), szektor, FAT, NTFS, ext, TSS, csapda, ütemezés, szál, szemafor, mutex, monitor, POSIX, szignál, osztott memória, csővezeték, kritikus szakasz, Wybe Dijkstra, CPU, erőforrás, holtpont, kiéheztetés, integrált áramkör, multiprogramozás, beágyazott rendszerek, partíció, MMU, lapcsere, FIFO, socket, lapozás, swap, interaktív rendszer, kötegelt rendszer, kliens, job, jogosultság, metaadat, könyvtár, UNIX, GNU/LINUX, erőforrás-foglalási gráf, fizikai memória, virtuális memória, merevlemez, floppy, fregmentáció, defregmentáló program, MFT, API, i-node, cache memory, SSH, HyperThread, párhuzamosság" />
<script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="js/kep.js"></script>
<script type="text/javascript" src="js/jquery.media.js"></script>
<script type="text/javascript" src="js/jquery.highlight-3.js"></script>
<script type="text/javascript" src="js/kereses.js"></script>
<script type="text/javascript" src="js/stylesheetToggle.js"></script>
<script type="text/javascript" src="js/cookie.js"></script>
<script type="text/javascript" src="js/stilusvalto.js"></script>
<script type="text/javascript" src="js/fogalmak.js"></script>
<script type="text/javascript" src="js/fogalom.js"></script>
<script type="text/javascript" src="js/jwplayer.js"></script>
<script type="text/javascript">
$(document).ready(function() 
{
$("a.hang").media( {width: 250, height: 50,  autoplay: false} );
});
</script>
<script type="text/javascript" src="js/navigacio.js"></script>
</head>
<body>
<div><a name="teteje"  id="teteje"></a></div>
<div class="jawsfmenu">
  <ul>
    <li><a class="tartalom" href="#tartalom" accesskey="t" tabindex="2">Ugrás a <span class="gyorsb">t</span>artalomra</a></li>
    <li><a class="tartalomj" href="#fejezetek" accesskey="j" tabindex="5">Ugrás a tartalom<span class="gyorsb">j</span>egyzékre</a></li>
    <li><a class="tanutm" href="#tanutm" accesskey="u" tabindex="7">Ugrás a tan<span class="gyorsb">u</span>lási útmutatóra</a></li>
  </ul>
</div>
<div class="ki_kereses"></div>
<div class="oldal">
  <div class="utmutato">
    <div class="utm_hivatkozasok"><span class="elozolap"><img src="navi/ikon_vissza_dis.gif" alt="Vissza az előzőleg látogatott oldalra (nem elérhető funkció)" title="Vissza az előzőleg látogatott oldalra (nem elérhető funkció)" /></span><a class="kezdolap" href="index.html" accesskey="p" tabindex="21"><img src="navi/ikon_kezdolap.gif" alt="Vissza a modul kezdőlapjára" title="Vissza a modul kezdőlapjára" width="36" height="36"/></a><a class="elozotanlap" href="lecke7_lap12.html" accesskey="e" tabindex="22"><img src="navi/ikon_elozolap.gif" alt="Ugrás a tananyag előző oldalára" title="Ugrás a tananyag előző oldalára" width="36" height="36" /></a><a class="kovetktanlap" href="lecke7_lap14.html" accesskey="v" tabindex="23"><img src="navi/ikon_kovetklap.gif" alt="Ugrás a tananyag következő oldalára" title="Ugrás a tananyag következő oldalára" width="36" height="36"/></a><span class="ki_fogalomkapcs"><img src="navi/ikon_fogalmakbe_dis.gif" alt="Fogalom megjelenítés (nem elérhető funckió)" title="Fogalom megjelenítés (nem elérhető funckió)" /></span><span class="ki_fogalomlista"><img src="navi/ikon_fogalmaklista_dis.gif" alt="Fogalmak listája (nem elérhető funkció)" title="Fogalmak listája (nem elérhető funkció)" /></span><span class="ki_nyomtatas"><img src="navi/ikon_nyomtatas_dis.gif" alt="Oldal nyomtatása (nem elérhető funkció)" title="Oldal nyomtatása (nem elérhető funkció)" /></span><a class="oldalterkep" href="oldalterkep.html" accesskey="d" tabindex="31"><img src="navi/ikon_oldalterkep.gif" alt="Oldaltérkép megtekintése" title="Oldaltérkép megtekintése"  width="36" height="36" /></a><a class="sugo" href="sugo.html" accesskey="s" tabindex="33"><img src="navi/ikon_sugo.gif" alt="Súgó megtekintése" title="Súgó megtekintése"  width="36" height="36" /></a></div>
  </div>
  <div class="tartalommenu">
    <div class="tartalommenu_fejlec"><span id="lapteteje"><a  href="#teteje"><span class="gyorsb">F</span>el a lap tetejére</a></span><a name="fejezetek"   id="fejezetek">Tartalomjegyzék</a></div>
    <ul><li><a href="#hiv1">Szignálok, a szülő-gyerek viszony gyakorlati szempontból</a><ul><li><a href="#hiv2">A szülő- és a gyermekfolyamatok</a><ul><li><a href="#hiv3">Példák a szülő- és a gyermekfolyamatokra egy C programozási nyelven írt programban</a><ul><li><a href="#hiv4">Feladat: készítsünk egy egyszerű &#132;démon&#148; programot! </a></li></ul></li></ul></li><li><a href="#hiv5">Szignálok</a><ul><li><a href="#hiv6">Példák a szignálok használatára egy C programozási nyelven írt programban</a><ul><li><a href="#hiv7">Feladat: készítsünk egy egyszerű programot, amely egy szignált küld egy másik programnak!</a></li></ul></li></ul></li></ul></li></ul> 
  </div>
  <div class="tartalom"> <a name="tartalom"    id="tartalom"></a> 
    <h1><a name="hiv1" id="hiv1"></a>Szignálok, a szülő-gyerek viszony gyakorlati szempontból</h1><h2><a name="hiv2" id="hiv2"></a>A szülő- és a gyermekfolyamatok</h2><h3><a name="hiv3" id="hiv3"></a>Példák a szülő- és a gyermekfolyamatokra egy C programozási nyelven írt programban</h3><div class="feladat"><span class="feladat">Feladat</span><h4><a name="hiv4" id="hiv4"></a>Feladat: készítsünk egy egyszerű &#132;démon&#148; programot! </h4><p>Legyen a feladatunk az, hogy készítsünk C programozási nyelven írt programot, amivel létrehozunk egy olyan egyszerű kis démon programot &lt;Demon.c&gt;, amelyik másodpercenként kiírja, hogy démon vagyok. </p></div><div class="forraskod"><div class="bekezdes1cm">

//-------------------- 
// Demon.c 
//-------------------- 
#include &lt;stdlib.h&gt; 
#include &lt;stdio.h&gt; 
#include &lt;unistd.h&gt; 
int main() { 
     daemon(1,1); // A démon folyamat indítása. 
     // Az első paraméter nulla, akkor a gyökérkönyvtárra vált. 
     // A második paraméter nulla, akkor a standard csatornákat átirányítja. 
     while (1) { 
          printf("demon vagyok\n"); 
          sleep(1); 
     } 
     return 0; 
} 
//--------------------
</div>
</div><p><strong>A futtatás eredménye</strong></p><div class="forraskod"><div class="bekezdes1cm">

&gt;gcc Demon.c  &ndash;o Demon 
&gt;./Demon 
demon vagyok 
demon vagyok 
demon vagyok
</div>
</div><p><strong>Megfigyelés</strong></p><p>A feladat megállításához felhasználói beavatkozás szükséges. (Leállítani a &#132;<strong>kill</strong> -9 PID_szám&#148; kiadásával lehet. A PID számhoz pedig a <strong>ps aux</strong> paranccsal juthatunk hozzá.) </p><h2><a name="hiv5" id="hiv5"></a>Szignálok</h2><p>A rendszerben futó folyamatok egymással többféleképpen kommunikálhatnak, például közös memóriaterületen vagy <span class="fogalom" title="csővezeték">csővezetéken</span> keresztül, vagy akár jelzésekkel is. A folyamatok közötti kommunikációt a szaknyelvben IPC-nek nevezik (InterProcess Communication). A jelzésekkel történő kommunikáció az egyik legegyszerűbb, hiszen ilyen módon nem lehet nagyobb mennyiségű információt átadni, mindössze a kapott jelzés típusát tudja megállapítani a fogadó fél. </p><p>Valahogy úgy kell elképzelni, mint a mindennapi életben a csipogó használatát, amellyel csak azt tudjuk közölni, hogy melyik telefonszámot kell felhívni, ám a beszélgetést magát nem lehet vele lefolytatni. </p><p>Talán még soha nem gondolt arra, de a már korábban használt a CTRL-C, a CTRL-Z vagy a CTRL-\ billentyűkombinációk leütésekor tulajdonképpen jelzéseket küldött a futó folyamatnak.</p><p>Például a CTRL-C hatására az <span class="fogalom" title="operációs rendszer">operációs rendszer</span> egy SIGINT jelzést küld, és ilyenkor alapesetben a processz azonnal befejeződik. A CTRL-Z billentyű lenyomására az <span class="fogalom" title="operációs rendszer">operációs rendszer</span> SIGTSTP jelzést generál, amely felfüggeszti a folyamatot. A CTRL-\ pedig egy SIGABRT <span class="fogalom" title="szignál">szignált</span> eredményez. Korábban már találkoztunk a parancssori szignálküldéssel. Idézzük az emlékezetünkbe, hogy hogyan is kellett ezt megtenni. Jelzéseket küldhetünk azoknak a futó programoknak, amelyeket szeretnénk megállítani, folytatni vagy véglegesen megszakítani. </p><p>Hozzunk létre egy hosszan futó programot, például adjuk ki a sleep 200 &#38; parancsot! A ps paranccsal megnézhetjük az aktuálisan futó folyamatokat. Állítsuk le a sleep parancsot a kill paranccsal, argumentumként megadva a jelzés típusát, illetve a <span class="fogalom" title="job">job</span> azonosítót vagy a PID számot!</p><!--fej7_kep_2--><div class="kep kozep" style="max-width:321px;"><img src="kepek/fej7_kep2_w321.jpg" alt="A képen a sleep 200 parancs eredmény és annak megállítása kill parancssal látható" style="width:100%; height:auto;" title="A képen a sleep 200 parancs eredmény és annak megállítása kill parancssal látható" /><span class="kepalairas">7.2. ábra: A sleep 200 &#38; parancs megállítása a kill paranccsal</span></div><div class="uresmargo"></div><!--ENDfej7_kep_2--><p>A jelzésekkel történő kommunikáció alapja a szignálkezelő mechanizmus. Ennek egyik oldalával, a jelzések küldésével most ismerkedünk meg, a másik oldalával, a jelzések fogadásával egy kicsit később találkozunk. </p><p>A folyamatok egymásnak különböző jelzéseket (<span class="fogalom" title="szignál">szignálokat</span>) küldhetnek egy bekövetkezett esemény hatására. A kiváltó esemény lehet valamilyen műveleti hiba, vagy akár külső esemény. Például a CTRL+C leütése, vagy akár valamilyen általunk kiadott kérés. </p><p>Tehát a jelzésekre mint speciális megszakításokra is gondolhatunk. A következő példában a saját jelzés küldését mutatjuk be. A régebbi <span class="fogalom" title="UNIX">UNIX</span> <span class="fogalom" title="operációs rendszer">operációs rendszerekben</span> mindössze 15 különböző jelzéstípus létezett, amelyek az idők során nem bizonyultak elegendőnek. A későbbiekben 31 darab különböző <span class="fogalom" title="szignál">szignált</span> definiáltak (a <span class="fogalom" title="POSIX">POSIX</span> szabványban), amelyeket egész számokkal jelenítettek meg. A jelzésekre hivatkozhatunk a szimbolikus konstans értékeken keresztül is. A mini referenciában utánanézhetünk ezeknek.</p><h3><a name="hiv6" id="hiv6"></a>Példák a szignálok használatára egy C programozási nyelven írt programban</h3><div class="feladat"><span class="feladat">Feladat</span><h4><a name="hiv7" id="hiv7"></a>Feladat: készítsünk egy egyszerű programot, amely egy szignált küld egy másik programnak!</h4><p>Legyen a feladatunk az, hogy készítsünk C++ programozási nyelven írt programot Sig_Kuld.c néven, amely a paraméterében kapott PID számú folyamatot állítja le, folytatja, majd megszakítja!</p></div><div class="forraskod"><div class="bekezdes1cm">

//-------------------- 
// SigKuld.c 
//-------------------- 
#include &lt;stdlib.h&gt; 
#include &lt;stdio.h&gt; 
#include &lt;string.h&gt; 
#include &lt;signal.h&gt;         // Például a kill függvény. 
#include &lt;sys/types.h&gt;      // Például a pid_t típus. 
int main(int argc, char * argv[]) { 
     int PID; 
     if (argc == 1) { 
          printf("Parameter kellene\n"); 
          exit(1); 
     } 
     PID = atoi(argv[1]); 
     kill(PID, SIGSTOP); // Leállítja a folyamatokat. 
     printf("Stop\n"); 
     fflush(stdout); 
     system("/bin/ps u"); 
     sleep(5); 
     kill(PID,SIGCONT); // Folytatja a leállítottat. 
     printf("Folytat\n"); 
     fflush(stdout); 
     system("/bin/ps u"); 
     sleep(5); 
     kill(PID, SIGKILL); // Megszakítja a futását. 
     printf("Befejezodott\n"); 
     fflush(stdout); 
     system("/bin/ps u"); 
      return 0; 
} 
//-------------------- 
</div>
</div><p><strong>A futtatás eredménye</strong></p><p>(Indítsunk a háttérben egy sleep-et, amit &#132;kilőhetünk&#148;.)</p><!--fej7_kep_3--><div class="kep kozep" style="max-width:638px;"><img src="kepek/fej7_kep3_w638.jpg" alt="A képen egy szignál küldése látható egy másik folyamatnak" style="width:100%; height:auto;" title="A képen egy szignál küldése látható egy másik folyamatnak" /><span class="kepalairas">7.3. ábra: Egy szignál küldése egy másik folyamatnak</span></div><div class="uresmargo"></div><!--ENDfej7_kep_3--><p><strong>Megfigyelés</strong></p><p>A kódunk futtatásával először leállítottuk a folyamatot (sleep). A ps segítségével nyomon követhetjük a sleep állapotát. A SIGSTOP jelzés után T, azaz &#132;terminált&#148; állapotba került. A SIGCONT jelzésre pedig S, azaz &#132;sleep&#148; állapotba van. A SIGKILL után megszűnik a folyamat, így nem látszódik a folyamatok között. </p><p>A jelzést megkapó folyamat nem tudja, hogy kitől érkezett a jelzés, csak a jelzés típusát tudja megállapítani. A jelzést fogadó folyamat a különböző típusú <span class="fogalom" title="szignál">szignálokra</span> különböző módon reagálhat. Úgy is fel lehet fogni a jelzésekkel való munkát, mint egyfajta megszakításkezelést. </p><p>Minden jelzéstípushoz tartozik egy úgynevezett alapértelmezett kezelésmód. A SIGKILL és a SIGSTOP jelzések hatása nem írható át &ndash; mindenképpen a folyamat leállítását okozza &ndash;, ezeket nevezzük <strong>nem maszkolható <span class="fogalom" title="szignál">szignáloknak</span>.</strong> Az egyes jelzések kezeléséhez be lehet állítani egy jelzéskezelő függvényt, amely az adott jelzés megérkezésekor végrehajtódik. Az <span class="fogalom" title="operációs rendszer">operációs rendszer</span> a jelzés fogadásakor meghívja ezt a függvényt &ndash; ezek az úgynevezett &#132;callback&#148; függvények. Mivel a függvényt az <span class="fogalom" title="operációs rendszer">operációs rendszer</span> hívja meg, a típusa előre rögzített. Paraméterként megkapja a jelzés típusát, visszaadott értéke pedig nincs (mivel void típusú). </p><p>A jelzésekre a következőképpen reagálhatnak a folyamatok: ha nincs a jelzéshez jelzéskezelő függvény definiálva: megállhatnak, vagy folytathatják, vagy megszakíthatják a működésüket, vagy figyelmen kívül hagyhatják a jelzést. </p><p class="vissza"><a href="#fejezetek">Vissza a tartalom<span class="gyorsb">j</span>egyzékhez</a></p> 
  </div>
</div>
<div class="utmutato_also">
  <div class="utm_hivatkozasok_also"><a class="oldalteteje" accesskey="f" href="#teteje"><span class="gyorsb">F</span>el a lap tetejére</a>
  <a class="elozotanlap" id="navialsoelozo" href="lecke7_lap12.html"><img src="navi/ikon_elozolap.gif" alt="Ugrás a tananyag előző oldalára" title="Ugrás a tananyag előző oldalára" width="36" height="36" /></a>
  <a id='navialsokov' class="kovetktanlap" href="lecke7_lap14.html" ><img src="navi/ikon_kovetklap.gif" alt="Ugrás a tananyag következő oldalára" title="Ugrás a tananyag következő oldalára" width="36" height="36"/></a>
  </div>
</div>
<div class="ki_stilus"></div>
<div class="impresszum">
  <table class="uszt">
    <tr>
      <td><div class="imp_eltetatklogo"><img alt="ELTE és ELTE TáTK logó" src="css/arculat/elte_plus_tatk.png" style="width:100%;height:auto;" /></div>
        <div class="imp_elteiklogo"><img alt="ELTE és ELTE IK logó" src="css/arculat/elte_plus_ik.png" style="width:100%;height:auto;" /></div></td>
      <td><div class="imp_uszt"><img alt="Új Széchenyi terv" src="css/arculat/USZT_logo_cmyk.jpg" style="width:100%;height:auto;" /></div></td>
      <td><div class="imp_eu"><img alt="A projekt az Európai Unió támogatásával, az Európai Szociális Alap társfinanszirozásával valósul meg." title="A projekt az Európai Unió támogatásával, az Európai Szociális Alap társfinanszirozásával valósul meg." src="css/arculat/ESZA.png" style="width:100%;height:auto;"/></div></td>
    </tr>
  </table>
</div>
</body>
</html>