<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="hu" lang="hu">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="css/scormelte_alap.css" rel="stylesheet" type="text/css" title="" />
<link href="css/style_spec.css" rel="stylesheet" type="text/css" />
<link href="css/scormelte_nagy.css" rel="alternate stylesheet" type="text/css" title="nagy" />
<link href="css/scormelte_inverz.css" rel="alternate stylesheet" type="text/css" title="inverz" />
<!--[if lte IE 6]>
<link href="css/scormelte_ie6.css" rel="stylesheet" type="text/css" title="" />
<![endif]-->
<!-- syntax highlight -->
<link rel="stylesheet" type="text/css" href="css/shCore.css" />
<link rel="stylesheet" type="text/css" href="css/shThemeDefault.css" />
<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushCpp.js"></script>
<script type="text/javascript" src="js/shBrushCSharp.js"></script>
<script type="text/javascript" src="js/shBrushDelphi.js"></script>
<script type="text/javascript" src="js/shBrushXml.js"></script>
<script type="text/javascript" src="js/shBrushCss.js"></script>
<script type="text/javascript" src="js/shBrushJScript.js"></script>
<script type="text/javascript" src="js/shBrushSql.js"></script>
<script type="text/javascript">
SyntaxHighlighter.all()
</script>
<title>
Számítógépes alapismeretek II. / 
<span class="fogalom" title="szignál">szignálok</span>, a szülő-gyerek viszony gyakorlati szempontból
/Feladat: készítsünk egy egyszerű &#132;shell&#148; programot! </title>
<meta name="description" content="A tananyag  fejlesztése a TÁMOP-4.1.2.A/2-10/1 pályázat keretén belül történt." />
<meta name="keywords" content="Hardver alapismeretek, operációs rendszer, számítógépes alapismeretek, operációs rendszer fogalma, operációs rendszerek története, operációs rendszer feladata, operációs rendszer generációk, operációs rendszer típusok, folyamatok, folyamat táblázat, szál &ndash; folyamatok, rendszerhívások, operációs rendszer struktúrák, kernelmód, kernel, felhasználói mód, B/K művelet, folyamatok modellje, szinkron rendszerhívás, asszinkron rendszerhívás, állapotai, megvalósításuk, folyamatok kommunikációja, IPC (Inter Process Communication), megszakítástábla, IDT, megszakításvezérlő, PIC, megszakítás, interrupt, megszakításkérelem, IRQ, megszakításkezelési folyamat, kivétel, hibakeresés (debuggolás), töréspont, fájlrendszer, MBR, partíciós szektor, Ntldr, klaszter (cluster), szektor, FAT, NTFS, ext, TSS, csapda, ütemezés, szál, szemafor, mutex, monitor, POSIX, szignál, osztott memória, csővezeték, kritikus szakasz, Wybe Dijkstra, CPU, erőforrás, holtpont, kiéheztetés, integrált áramkör, multiprogramozás, beágyazott rendszerek, partíció, MMU, lapcsere, FIFO, socket, lapozás, swap, interaktív rendszer, kötegelt rendszer, kliens, job, jogosultság, metaadat, könyvtár, UNIX, GNU/LINUX, erőforrás-foglalási gráf, fizikai memória, virtuális memória, merevlemez, floppy, fregmentáció, defregmentáló program, MFT, API, i-node, cache memory, SSH, HyperThread, párhuzamosság" />
<script type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
<script type="text/javascript" src="js/kep.js"></script>
<script type="text/javascript" src="js/jquery.media.js"></script>
<script type="text/javascript" src="js/jquery.highlight-3.js"></script>
<script type="text/javascript" src="js/kereses.js"></script>
<script type="text/javascript" src="js/stylesheetToggle.js"></script>
<script type="text/javascript" src="js/cookie.js"></script>
<script type="text/javascript" src="js/stilusvalto.js"></script>
<script type="text/javascript" src="js/fogalmak.js"></script>
<script type="text/javascript" src="js/fogalom.js"></script>
<script type="text/javascript" src="js/jwplayer.js"></script>
<script type="text/javascript">
$(document).ready(function() 
{
$("a.hang").media( {width: 250, height: 50,  autoplay: false} );
});
</script>
<script type="text/javascript" src="js/navigacio.js"></script>
</head>
<body>
<div><a name="teteje"  id="teteje"></a></div>
<div class="jawsfmenu">
  <ul>
    <li><a class="tartalom" href="#tartalom" accesskey="t" tabindex="2">Ugrás a <span class="gyorsb">t</span>artalomra</a></li>
    <li><a class="tartalomj" href="#fejezetek" accesskey="j" tabindex="5">Ugrás a tartalom<span class="gyorsb">j</span>egyzékre</a></li>
    <li><a class="tanutm" href="#tanutm" accesskey="u" tabindex="7">Ugrás a tan<span class="gyorsb">u</span>lási útmutatóra</a></li>
  </ul>
</div>
<div class="ki_kereses"></div>
<div class="oldal">
  <div class="utmutato">
    <div class="utm_hivatkozasok"><span class="elozolap"><img src="navi/ikon_vissza_dis.gif" alt="Vissza az előzőleg látogatott oldalra (nem elérhető funkció)" title="Vissza az előzőleg látogatott oldalra (nem elérhető funkció)" /></span><a class="kezdolap" href="index.html" accesskey="p" tabindex="21"><img src="navi/ikon_kezdolap.gif" alt="Vissza a modul kezdőlapjára" title="Vissza a modul kezdőlapjára" width="36" height="36"/></a><a class="elozotanlap" href="lecke7_lap11.html" accesskey="e" tabindex="22"><img src="navi/ikon_elozolap.gif" alt="Ugrás a tananyag előző oldalára" title="Ugrás a tananyag előző oldalára" width="36" height="36" /></a><a class="kovetktanlap" href="lecke7_lap13.html" accesskey="v" tabindex="23"><img src="navi/ikon_kovetklap.gif" alt="Ugrás a tananyag következő oldalára" title="Ugrás a tananyag következő oldalára" width="36" height="36"/></a><span class="ki_fogalomkapcs"><img src="navi/ikon_fogalmakbe_dis.gif" alt="Fogalom megjelenítés (nem elérhető funckió)" title="Fogalom megjelenítés (nem elérhető funckió)" /></span><span class="ki_fogalomlista"><img src="navi/ikon_fogalmaklista_dis.gif" alt="Fogalmak listája (nem elérhető funkció)" title="Fogalmak listája (nem elérhető funkció)" /></span><span class="ki_nyomtatas"><img src="navi/ikon_nyomtatas_dis.gif" alt="Oldal nyomtatása (nem elérhető funkció)" title="Oldal nyomtatása (nem elérhető funkció)" /></span><a class="oldalterkep" href="oldalterkep.html" accesskey="d" tabindex="31"><img src="navi/ikon_oldalterkep.gif" alt="Oldaltérkép megtekintése" title="Oldaltérkép megtekintése"  width="36" height="36" /></a><a class="sugo" href="sugo.html" accesskey="s" tabindex="33"><img src="navi/ikon_sugo.gif" alt="Súgó megtekintése" title="Súgó megtekintése"  width="36" height="36" /></a></div>
  </div>
  <div class="tartalommenu">
    <div class="tartalommenu_fejlec"><span id="lapteteje"><a  href="#teteje"><span class="gyorsb">F</span>el a lap tetejére</a></span><a name="fejezetek"   id="fejezetek">Tartalomjegyzék</a></div>
    <ul><li><a href="#hiv1">Szignálok, a szülő-gyerek viszony gyakorlati szempontból</a><ul><li><a href="#hiv2">A szülő- és a gyermekfolyamatok</a><ul><li><a href="#hiv3">Példák a szülő- és a gyermekfolyamatokra egy C programozási nyelven írt programban</a><ul><li><a href="#hiv4">Feladat: készítsünk egy egyszerű &#132;shell&#148; programot! </a></li></ul></li></ul></li></ul></li></ul> 
  </div>
  <div class="tartalom"> <a name="tartalom"    id="tartalom"></a> 
    <h1><a name="hiv1" id="hiv1"></a>Szignálok, a szülő-gyerek viszony gyakorlati szempontból</h1><h2><a name="hiv2" id="hiv2"></a>A szülő- és a gyermekfolyamatok</h2><h3><a name="hiv3" id="hiv3"></a>Példák a szülő- és a gyermekfolyamatokra egy C programozási nyelven írt programban</h3><div class="feladat"><span class="feladat">Feladat</span><h4><a name="hiv4" id="hiv4"></a>Feladat: készítsünk egy egyszerű &#132;shell&#148; programot! </h4><p>Legyen a feladatunk az, hogy készítsünk C programozási nyelven írt programot, amivel létrehozunk egy egyszerű &#132;shell&#148; programot, amely a billentyűzetről olvassa be a parancsokat! (Hozzunk létre minden beolvasott parancshoz egy-egy gyermekfolyamatot, majd hajtsuk végre ezeket az <strong>exec</strong> függvénycsalád segítségével. FIGYELEM! Nehogy túl sok <strong>fork</strong> hívást végezzünk! Óvatosan dolgozzunk!) </p></div><div class="forraskod"><div class="bekezdes1cm">
 //-------------------- 
// MyShell.c 
//-------------------- 
#include &lt;stdlib.h&gt; 
#include &lt;stdio.h&gt; 
#include &lt;unistd.h&gt;        // Például a fork. 
#include &lt;string.h&gt;        // Például az strtok. 
#include &lt;sys/wait.h&gt;      // Például a wait, és a waitpid. 
#include &lt;sys/types.h&gt;     // Például a pid_t típus. 
 
char cmd[80]; 
char * arg[10]; 
char line[80]="   "; 
int argc; 
 
void my_split() { // Feldarabolja a beolvasott sort a space-ek mentén. 
     int i = 0; 
     argc = 0; 
     arg[argc] = strtok(line," "); 
     while (arg[argc] != NULL) { 
          printf("arg %s\n", arg[argc]); 
          argc++; 
          arg[argc] = strtok(NULL," "); 
     } 
     arg[++argc] = NULL; 
     strcpy(cmd, arg[0]); 
} 
 
int main() { 
     pid_t child; 
     int status; 
     printf("Befejezodik, ha egyetlen . kerul a prompt soraba, majd egy 
             ENTER-t utunk"); 
     printf("\n&gt;&gt; "); 
     fgets(line, 80, stdin); 
     while (strcmp(line,".\n") != 0) { 
          my_split(); 
          child = fork();   // A gyermekfolyamat létrehozása. 
          if (child == 0) { // A gyermek. 
               printf("Vegrehajtas indul\n"); 
               execv(cmd, arg);  // A gyermekfolyamat &#132;lecserélése&#148; a
                                 // megadott paraméterben megadott parancsra. 
          } else{ // A szülő. 
               waitpid(child, &#38;status, 0); // A gyermekfolyamat 
                                           // befejeződését várja. 
               printf("A %s parancs vegrahajtas vege\n", cmd); 
               printf("\n&gt;&gt; "); 
               strcpy(line, "   "); 
               fgets(line, 80, stdin); 
          } 
      } 
     printf("Vege a programnak\n"); 
     return 0; 
} 
//-------------------- 
</div>
</div><p><strong>A futtatás eredménye</strong></p><div class="forraskod"><div class="bekezdes1cm">

&gt;gcc MyShell.c  &ndash;o MyShell 
&gt;./MyShell 
Befejezodik, ha egyetlen . kerul a prompt soraba, majd egy Entert utunk 
&gt;&gt;./Vszam 3 
Vegrehajtas indul 
83,86,77, 
A ./Vszam parancs vegrehajtas vege 
&gt;&gt; ./Vszam 6 
Vegrehajtas indul 
83,86,77,54,43,11, 
A ./Vszam parancs vegrehajtas vege 
&gt;&gt;.
Vege a programnak 
</div>
</div><p><strong>Megfigyelés</strong></p><p>A saját shell programunk prompt jele legyen különböző az eredeti prompttól! Látható, hogy az egyes parancsokat végrehajtja, és bevárja a gyermekfolyamatot, ahogy azt a korábbiak alapján feltételeztük. </p><p>Végezetül beszélnünk kell egy speciális gyermekfolyamatról. Előfordulhat, hogy egy adott feladatot sokáig szeretnénk futtatni a háttérben úgy, hogy bizonyos események bekövetkeztekor szolgáltatásokat végezzen. Az ilyen speciális programot <strong>démonnak</strong> nevezzük. A démonok közvetlenül nincsenek kapcsolatban az egyes felhasználókkal. Ilyen programot a <strong>daemon</strong> függvény hívásával lehet készíteni, amely tulajdonképpen létrehoz egy gyermekfolyamatot, majd kilép. Egy egyszerű &#132;forkolástól&#148; annyiban különbözik ez a módszer, hogy a munkakönyvtárat módosítani lehet a gyökérkönyvtárra &ndash; ez a hosszú, felhasználóktól független futás biztosításához szükséges. Továbbá a létrehozás pillanatában a standard csatornákat a <strong>dev</strong>/<strong>null</strong>-ra lehet irányítani azért, hogy a felesleges kiírásokat ne lássunk. </p><p class="vissza"><a href="#fejezetek">Vissza a tartalom<span class="gyorsb">j</span>egyzékhez</a></p> 
  </div>
</div>
<div class="utmutato_also">
  <div class="utm_hivatkozasok_also"><a class="oldalteteje" accesskey="f" href="#teteje"><span class="gyorsb">F</span>el a lap tetejére</a>
  <a class="elozotanlap" id="navialsoelozo" href="lecke7_lap11.html"><img src="navi/ikon_elozolap.gif" alt="Ugrás a tananyag előző oldalára" title="Ugrás a tananyag előző oldalára" width="36" height="36" /></a>
  <a id='navialsokov' class="kovetktanlap" href="lecke7_lap13.html" ><img src="navi/ikon_kovetklap.gif" alt="Ugrás a tananyag következő oldalára" title="Ugrás a tananyag következő oldalára" width="36" height="36"/></a>
  </div>
</div>
<div class="ki_stilus"></div>
<div class="impresszum">
  <table class="uszt">
    <tr>
      <td><div class="imp_eltetatklogo"><img alt="ELTE és ELTE TáTK logó" src="css/arculat/elte_plus_tatk.png" style="width:100%;height:auto;" /></div>
        <div class="imp_elteiklogo"><img alt="ELTE és ELTE IK logó" src="css/arculat/elte_plus_ik.png" style="width:100%;height:auto;" /></div></td>
      <td><div class="imp_uszt"><img alt="Új Széchenyi terv" src="css/arculat/USZT_logo_cmyk.jpg" style="width:100%;height:auto;" /></div></td>
      <td><div class="imp_eu"><img alt="A projekt az Európai Unió támogatásával, az Európai Szociális Alap társfinanszirozásával valósul meg." title="A projekt az Európai Unió támogatásával, az Európai Szociális Alap társfinanszirozásával valósul meg." src="css/arculat/ESZA.png" style="width:100%;height:auto;"/></div></td>
    </tr>
  </table>
</div>
</body>
</html>